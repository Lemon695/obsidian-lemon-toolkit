# Lemon Toolkit

一个为 Obsidian 设计的个人效率工具包插件，提供实用的辅助功能。

## 功能特性

### 复制路径命令

通过键盘快捷键快速复制各种格式的文件路径：

- **复制相对路径** - 复制相对于仓库根目录的文件路径
- **复制绝对路径** - 复制完整的系统路径（仅桌面端）
- **复制文件名** - 复制带扩展名的文件名
- **复制文件名（无扩展名）** - 复制不带扩展名的文件名

所有命令都会显示确认通知，展示已复制的内容。

### 删除文件命令

提供两种文件删除选项：

- **永久删除文件** - 从仓库中永久删除当前文件
- **删除文件到回收站** - 将当前文件移动到 Obsidian 回收站（.trash 文件夹）

### 文件管理命令

- **复制文件** - 复制当前文件并弹出重命名对话框。默认文件名包含后缀（如时间戳：`filename-1733234567890.md` 或 UUID：`filename-a1b2c3d4.md`），可在确认前修改
- **移动文件到文件夹** - 将当前文件移动到指定文件夹，带智能历史记录。文件夹列表优先显示最近使用的文件夹，支持输入筛选。插件会自动追踪所有文件移动操作（包括拖拽和 Obsidian 原生移动）

### 标签管理命令

- **查看当前标签** - 在弹窗中显示当前文件的所有标签。点击任意标签可复制到剪贴板
- **插入标签** - 在光标位置插入标签，支持多选。标签按使用频率或最近使用时间排序（可在设置中配置）。包含搜索筛选功能，快速查找标签。插件会自动追踪你在笔记中手动输入的标签

### 命令面板

- **打开命令面板** - 打开专属的命令面板，仅显示 Lemon Toolkit 的命令。命令按最近使用时间排序，固定的命令始终显示在最上面。支持模糊搜索和使用统计
- **打开设置** - 快速打开插件设置页面，修改配置

### 文件信息视图

- **打开文件信息** - 打开侧边栏视图，显示当前文件的完整信息：
  - 基础信息（文件名、路径、日期、大小、字数、阅读时间）
  - Frontmatter 字段，格式化显示
  - 所有标签（可点击搜索）
  - 出链和入链（可点击跳转）
  - 文件位置面包屑导航
  - 切换文件或修改内容时自动更新
  - 点击文件名/路径可复制

### 智能最近文件

- **打开最近文件** - 打开智能侧边栏视图，管理你的最近文件：
  - **三个标签页**：最近编辑、最近查看、最近新增
  - **固定文件** - 将常用文件固定到顶部，快速访问
  - **时间显示** - 显示每个文件的最后访问时间（如 "2小时前"、"3天前"）
  - **右键菜单** - 快捷操作：固定/取消固定、在新标签页打开、在导航中显示、移动或删除
  - **自动追踪** - 自动追踪文件的编辑、查看和创建记录
  - **简洁界面** - 现代化、有序的 UI 设计，清晰的视觉层次

### Frontmatter 编辑器

- **编辑 Frontmatter** - 打开模态对话框编辑 frontmatter 字段，无需进入编辑模式：
  - 查看和编辑所有 frontmatter 字段
  - 添加新字段并选择类型
  - 删除现有字段
  - 搜索/筛选字段
  - 常用操作的快捷按钮
  - 类型感知编辑（字符串、数字、布尔值、日期、数组）
  - 自动保存并验证

### 选中文本快捷操作

- **文本选择操作** - 选中文本后的快捷操作（选中文本后运行命令）：
  - 用选中文本创建新笔记（替换为链接）
  - 全局搜索选中文本
  - 包裹为 [[wiki-link]]
  - 包裹为 callout（多种类型）
  - 添加为标签
  - 复制为引用格式
  - 发送/追加到其他文件

### 外部应用打开

- **外部应用管理** - 配置外部应用程序打开文件和文件夹：
  - 在设置中添加自定义应用程序（名称、路径）
  - 配置应用是否可以打开文件/文件夹
  - 自动为每个应用生成命令
  - 支持 macOS、Windows、Linux
  - 可添加任意数量的应用程序

### 标题序号管理

- **添加/更新标题序号** - 自动为所有标题添加或更新层级序号：
  - 支持多级序号（1、1.1、1.2、1.2.1 等）
  - 应用前预览更改
  - 高亮显示修改的标题
  - 保留标题文本内容
  - 智能识别已有序号
  
- **移除标题序号** - 移除文档中所有标题的序号

## 使用方法

1. 在仓库中打开任意文件
2. 打开命令面板（Ctrl/Cmd + P）
3. 搜索 "Lemon Toolkit" 命令
4. 选择需要的复制命令
5. 内容将被复制到剪贴板，并显示确认通知

### 命令列表

| 命令 | 说明 |
|------|------|
| `Lemon Toolkit: Copy relative path` | 复制相对于仓库根目录的文件路径 |
| `Lemon Toolkit: Copy absolute path` | 复制完整的系统路径 |
| `Lemon Toolkit: Copy file name` | 复制带扩展名的文件名 |
| `Lemon Toolkit: Copy file name (no extension)` | 复制不带扩展名的文件名 |
| `Lemon Toolkit: Delete file permanently` | 永久删除当前文件 |
| `Lemon Toolkit: Delete file to trash` | 将当前文件移动到 Obsidian 回收站 |
| `Lemon Toolkit: Duplicate file` | 复制当前文件并弹出重命名对话框 |
| `Lemon Toolkit: Move file to folder` | 将当前文件移动到指定文件夹（带智能历史记录） |
| `Lemon Toolkit: View current tags` | 查看当前文件的所有标签 |
| `Lemon Toolkit: Insert tags` | 在光标位置插入标签 |
| `Lemon Toolkit: Open command palette` | 打开 Lemon Toolkit 命令面板 |
| `Lemon Toolkit: Open settings` | 打开插件设置页面 |
| `Lemon Toolkit: Open file info` | 打开文件信息侧边栏 |
| `Lemon Toolkit: Edit frontmatter` | 在模态对话框中编辑 frontmatter 字段 |
| `Lemon Toolkit: Text selection actions` | 选中文本的快捷操作 |
| `Lemon Toolkit: Add/update heading numbering` | 添加或更新标题的层级序号 |
| `Lemon Toolkit: Remove heading numbering` | 移除所有标题序号 |

## 安装方法

### 从 Obsidian 社区插件安装

1. 打开 **设置** → **第三方插件**
2. 选择 **浏览** 并搜索 "Lemon Toolkit"
3. 选择 **安装**
4. 安装完成后，选择 **启用**

### 手动安装

1. 从 [Releases](https://github.com/yourusername/lemon-toolkit/releases) 页面下载最新版本
2. 将文件解压到仓库的插件文件夹：`<vault>/.obsidian/plugins/lemon-toolkit/`
3. 重新加载 Obsidian
4. 在 **设置** → **第三方插件** 中启用该插件

## 设置

在 **设置** → **Lemon Toolkit** 中可以配置：

### 复制文件

- **复制文件后缀类型** - 选择复制文件时添加的后缀格式
  - 时间戳（默认）：`filename-1733234567890.md`
  - UUID：`filename-a1b2c3d4.md`

### 移动文件

- **文件夹列表排序方式** - 选择移动文件时文件夹列表的排序方式
  - 最近使用（默认）：最近移动过的文件夹显示在最上面
  - 最近 24 小时使用最多：按最近一天内的移动次数排序
  - 最近 7 天使用最多：按最近一周内的移动次数排序
  - 最近 30 天使用最多：按最近一个月内的移动次数排序

注意：插件会自动追踪所有文件移动操作，包括拖拽、右键移动和 Obsidian 原生文件操作。

### 标签

- **标签列表排序方式** - 选择插入标签时标签列表的排序方式
  - 最近使用（默认）：最近使用的标签显示在最上面
  - 最近 24 小时使用最多：按最近一天内的使用次数排序
  - 最近 7 天使用最多：按最近一周内的使用次数排序
  - 最近 30 天使用最多：按最近一个月内的使用次数排序
  - 字母顺序：按字母顺序排序标签

注意：插件会自动追踪你在笔记中手动输入的标签，不仅限于使用插入标签命令时。

### 命令面板

- **固定命令** - 选择要固定在命令面板顶部的命令。固定的命令将始终显示在最前面，其后是最近使用的命令

### 文件信息视图

- **显示阅读时间** - 根据字数显示预估阅读时间（默认：启用）
- **日期时间格式** - 自定义日期和时间的显示格式（默认：YYYY-MM-DD HH:mm）

### Frontmatter 编辑器

- **显示类型图标** - 在字段名旁显示类型图标（默认：启用）
- **保存后关闭** - 保存后自动关闭编辑器（默认：禁用）
- **日期格式** - 日期字段的格式（默认：YYYY-MM-DD）

### 外部应用

- **管理外部应用** - 配置外部应用程序列表
  - 添加应用名称和完整路径
  - 选择是否可以打开文件
  - 选择是否可以打开文件夹
  - 保存后自动生成对应命令

## 兼容性

- 最低 Obsidian 版本：1.0.0
- 支持桌面端（Windows、macOS、Linux）
- 支持移动端（iOS、Android），部分功能受限
  - 注意：移动设备上无法使用绝对路径复制功能

## 开发

本插件使用 TypeScript 构建，采用模块化架构，易于扩展。

### 构建插件

```bash
# 安装依赖
npm install

# 开发模式（带监听）
npm run dev

# 生产构建
npm run build
```

### 项目结构

```
src/
├── main.ts              # 插件入口
├── settings.ts          # 插件设置接口
├── commands/
│   ├── index.ts         # 命令注册
│   ├── copyPath.ts      # 复制路径功能实现
│   ├── deleteFile.ts    # 删除文件功能实现
│   ├── duplicateFile.ts # 复制文件功能实现
│   ├── moveFile.ts      # 移动文件功能实现
│   ├── tags.ts          # 标签管理功能实现
│   ├── commandPalette.ts # 命令面板功能实现
│   └── openSettings.ts  # 打开设置功能实现
├── views/
│   └── FileInfoView.ts  # 文件信息侧边栏视图
├── ui/
│   ├── DuplicateFileModal.ts # 重命名复制文件的弹窗
│   ├── MoveFileModal.ts      # 移动文件的弹窗（带历史记录）
│   ├── ViewCurrentTagsModal.ts # 查看当前标签的弹窗
│   ├── InsertTagsModal.ts    # 插入标签的弹窗
│   ├── CommandPaletteModal.ts # Lemon Toolkit 命令面板弹窗
│   ├── PinnedCommandsModal.ts # 管理固定命令的弹窗
│   └── SettingTab.ts         # 插件设置面板
└── utils/
    ├── clipboard.ts     # 剪贴板工具
    └── suffix.ts        # 后缀生成工具
```

## 支持

如果遇到任何问题或有功能建议，请在 GitHub 上[提交 issue](https://github.com/Lemon695/obsidian-lemon-toolkit/issues)。

## 许可证

MIT 许可证 - 详见 [LICENSE](LICENSE) 文件。

## 致谢

基于 [Obsidian API](https://docs.obsidian.md) 构建。
